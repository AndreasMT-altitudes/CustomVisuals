{"visual":{"name":"demoCreation","displayName":"demoCreation","guid":"demoCreation522AEF1866B94124B4C4F588A968843A","visualClassName":"Visual","version":"1.0.0.0","description":"Demo","supportUrl":"Demo.dk","gitHubUrl":""},"author":{"name":"Andreas Methling","email":"andreas.methling@gmail.com"},"apiVersion":"3.8.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Category","description":"Category to show on the x_axis","name":"category","kind":"Grouping"},{"displayName":"Lower column value 1","name":"l_col1","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 2","name":"l_col2","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 3","name":"l_col3","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 4","name":"l_col4","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 5","name":"l_col5","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 1","name":"u_col1","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 2","name":"u_col2","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 3","name":"u_col3","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 4","name":"u_col4","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 5","name":"u_col5","kind":"GroupingOrMeasure"},{"displayName":"Small Multiple","name":"small_multi","kind":"GroupingOrMeasure"}],"dataViewMappings":[{"conditions":[{"category":{"max":1},"l_col1":{"max":1},"l_col2":{"min":0,"max":1},"l_col3":{"min":0,"max":1},"l_col4":{"min":0,"max":1},"l_col5":{"min":0,"max":1},"u_col1":{"max":1},"u_col2":{"min":0,"max":1},"u_col3":{"min":0,"max":1},"u_col4":{"min":0,"max":1},"u_col5":{"min":0,"max":1},"small_multi":{"min":0,"max":1}}],"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"category"}},{"for":{"in":"l_col1"}},{"for":{"in":"l_col2"}},{"for":{"in":"l_col3"}},{"for":{"in":"l_col4"}},{"for":{"in":"l_col5"}},{"for":{"in":"u_col1"}},{"for":{"in":"u_col2"}},{"for":{"in":"u_col3"}},{"for":{"in":"u_col4"}},{"for":{"in":"u_col5"}},{"for":{"in":"small_multi"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"############### Utility functions ###############\nlibraryRequireInstall = function(packageName, ...)\n{\n  if(!require(packageName, character.only = TRUE)) \n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\n}\n\nlibraryRequireInstall(\"xml2\")\nlibraryRequireInstall(\"htmlwidgets\")\n\ninternalSaveWidget <- function(widget, fname)\n{\n  tempFname = paste(fname, \".tmp\", sep=\"\")\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\n  FlattenHTML(tempFname, fname)\n}\n\nFlattenHTML <- function(fnameIn, fnameOut)\n{\n  # Read and parse HTML file\n  # Embed all js and css files into one unified file\n  \n  if(!file.exists(fnameIn))\n    return(FALSE)\n  \n  dir = dirname(fnameIn)\n  html = read_html(fnameIn, useInternal = TRUE)\n  top = xml_root(html)\n  \n  # extract all <script> tags with src value\n  srcNode=xml_find_all(top, '//script[@src]')\n  for (node in srcNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['src'])\n    alternateSrc = FindSrcReplacement(fname)\n    if (!is.null(alternateSrc))\n    {\n      s = alternateSrc\n      names(s) = 'src'\n      newNode = xml_new_root(\"script\")\n      xml_set_attrs(newNode, s)\n      xml_replace(node, newNode)\n    }else{\n      str=ReadFileForEmbedding(fname);\n      if (!is.null(str))\n      {      \n        newNode = xml_new_root(\"script\",str)\n        xml_set_attrs( newNode, c( type = \"text/javascript\") )\n        xml_replace(node, newNode)\n      }\n    }\n  }\n  \n  # extract all <link> tags with src value\n  linkNode=xml_find_all(top, '//link[@href]')\n  for (node in linkNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['href'])\n    str = ReadFileForEmbedding(fname, FALSE);\n    if (!is.null(str))\n    {\n      newNode = xml_new_root(\"style\", str)\n      xml_replace(node, newNode)\n    }\n  }\n  \n  write_xml(html, file = fnameOut)\n  return(TRUE)\n}\n\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\n{\n  data = ReadFullFile(fname)\n  if (is.null(data))\n    return(NULL)\n\n  str = paste(data, collapse ='\\n')\n  if (addCdata) {\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\n  }\n  return(str)\n}\n\nReadFullFile <- function(fname)\n{\n  if(!file.exists(fname))\n    return(NULL)\n  \n  con = file(fname, open = \"r\")\n  data = readLines(con)\n  close(con)\n  return(data)\n}\n\nFindSrcReplacement <- function(str)\n{\n  # finds reference to 'plotly' js and replaces with a version from CDN\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\n  str <- iconv(str, to=\"UTF-8\")\n  pattern = \"plotly-(\\\\w.+)/plotly-latest.min.js\"\n  match1=regexpr(pattern, str)\n  attr(match1, 'useBytes') <- FALSE\n  strMatch=regmatches(str, match1, invert = FALSE)\n  if (length(strMatch) == 0) return(NULL)\n  \n  pattern2 = \"-(\\\\d.+)/\"\n  match2 = regexpr(pattern2, strMatch[1])\n  attr(match2, 'useBytes') <- FALSE\n  strmatch = regmatches(strMatch[1], match2)\n  if (length(strmatch) == 0) return(NULL)\n  \n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\n  # This matches the specific version used in the plotly package used.\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\n  return(str)\n}\n\nReadFullFileReplaceString <- function(fnameIn, fnameOut, sourceString,targetString) {\n  # Replaces texts in file\n  # This makes it possible to replace e.g. paddings in the generated html widget code\n  if(!file.exists(fnameIn))\n    return(NULL)\n  tx  <- readLines(fnameIn,encoding = \"UTF-8\")\n  tx2  <- gsub(pattern = sourceString, replace = targetString, x = tx)\n  writeLines(tx2, con = fnameOut)\n}\n#################################################\n\n\n############### Library Declarations ###############\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"ggplot2\")));\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"plotly\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"tidyverse\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"scales\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"tsibble\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"lubridate\")))\n####################################################\n\n################### Actual code ####################\n###################Dealing with errors##############\nif(!exists(\"category\")) {\n  errorText <- \"There needs to be a categorical column\n                </br> in the Category field\"\n  g = ggplot() + geom_text(aes(x = 0.5, y = 0.5, label = errorText), size = 5) +\n    theme(\n      axis.title.x = element_blank(),\n      axis.text.x = element_blank(),\n      axis.ticks.x = element_blank(),\n      axis.title.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.ticks.y = element_blank()\n    )\n  p = ggplotly(g) %>%\n    layout(plot_bgcolor='#FFFFFF',\n           yaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE),\n           xaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE))\n  internalSaveWidget(p, 'out.html')\n  ReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n  quit()                       \n}\n\n###########Settings defualt values for formating options############\nnum_cols <- 5\n\n##Setting Labels to True in the enviroment, if nothing is supplied\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"LowerColumnValue\", i, \"Format_textLabel\")\n  if (!exists(label_name)) {\n    assign(label_name, FALSE, envir = .GlobalEnv)\n  }\n}\n\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"UpperColumnValue\", i, \"Format_textLabel\")\n  if (!exists(label_name)) {\n    assign(label_name, FALSE, envir = .GlobalEnv)\n  }\n}\n\n\n##Setting label placement to default values if nothing else is supplied\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"LowerColumnValue\", i, \"Format_labelPlace\")\n  if (!exists(label_name)) {\n    assign(label_name, \"top\", envir = .GlobalEnv)\n  }\n}\n\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"UpperColumnValue\", i, \"Format_labelPlace\")\n  if (!exists(label_name)) {\n    assign(label_name, \"top\", envir = .GlobalEnv)\n  }\n}\n\n##########Axes Settings###################\nif (!exists(\"mySettingsAxes_textSize\")) {\n  mySettingsAxes_textSize = 10/2.8\n} else {\n  mySettingsAxes_textSize = mySettingsAxes_textSize/2.8\n}\n\nif (!exists(\"mySettingsAxes_colLabel\")) {\n  mySettingsAxes_colLabel = \"black\"\n}\n\nif (!exists(\"mySettingsAxes_x_axis_title\")) {\n  mySettingsAxes_x_axis_title = \"\"\n}\n\nif (!exists(\"mySettingsAxes_y_axis_title\")) {\n  mySettingsAxes_y_axis_title = \"\"\n}\n\n\nupdate_geom_defaults(\"text\", list(size = mySettingsAxes_textSize, color = mySettingsAxes_colLabel)) ##sæt nu genereal size her\n\n#############Create Values- dataset from user selected fields####################\n# Set the number of columns\n\ncategory[] <- lapply(category[1], as.character)\n\nValues <- data.frame(category)\nValues2 <- data.frame(category)\n\ninitialize_data_frame <- function(df, str) {\n  if (exists(\"small_multi\")) {\n    small_multi[] <- lapply(small_multi[1], as.character)\n    df <- data.frame(category, small_multi)\n    colnames(df)[length(df)] <- \"small\"\n  }\n\n  for (i in 1:num_cols) {\n    col_name <- paste(str, \"_col\", i, sep = \"\")\n    if (exists(\"category\") && exists(col_name)) {\n      df[[col_name]] <- get(col_name)\n      colnames(df)[length(df)] <- colnames(get(col_name))\n    }\n  }\n  return(df)\n}\n\nValues <- initialize_data_frame(Values, \"l\")\nValues2 <- initialize_data_frame(Values2, \"u\")\n\n\n#######Color Specefications\ndefault_labels <- c(\"#73b761\", \"#4a588a\", \"#ecc846\", \"#cd4c46\", \"#71afe2\", \"#8d6fd1\", \"#ee9e64\", \"#95dabb\", \"#8fc581\", \"#6e79a1\")\ncolors = c()\ncolors2 = c()\n\ncolors <- lapply(1:num_cols, function(i) {\n  label_name <- paste(\"LowerColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  col_name <- paste(\"l_col\", i, sep = \"\")\n  if (!exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = default_labels[i]\n    value = col_vec[name]\n    return(col_vec)\n  } else if (exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = get(label_name)\n    value = col_vec[name]\n    return(value)\n  }\n})\n\ncolors2 <- lapply(1:num_cols, function(i) {\n  label_name <- paste(\"UpperColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  col_name <- paste(\"u_col\", i, sep = \"\")\n  label <- 5 + i\n  if (!exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = default_labels[label]\n    value = col_vec[name]\n    return(col_vec)\n  } else if (exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = get(label_name)\n    value = col_vec[name]\n    return(value)\n  }\n})\n\nall_colors <- unlist(c(colors, colors2))\n\n###########Transforming Dataframe###############\ncolnames(Values)[1] = \"x_axis\"\ncolnames(Values2)[1] = \"x_axis\"\n\n\n#Function to make alphabetical order of columns\nassign_numeric_order <- function(data, type_column) {\n  data %>%\n    mutate(numeric_order = match({{type_column}}, rev(sort(unique({{type_column}})))))\n}\n\n# Function to create summary data frame\ncreate_summary_df <- function(data) {\n  if (exists(\"small_multi\") && length(data) > 2) {\n    df = data %>%\n      group_by(x_axis, small) %>%\n      summarise_all(list(c(sum = \"sum\"))) %>%\n      pivot_longer(c(-x_axis, -small), names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10),\n      values2 = paste0(as.character(round(values / 1e6, 0)), \"M\")) %>%\n      assign_numeric_order(type_column = type) %>%\n      group_by(x_axis, small) %>%\n      arrange(x_axis,small, numeric_order) %>%\n      mutate(sum_values = accumulate(values, ~.x + .y)[numeric_order]) %>%\n      ungroup()\n  } else if (!exists(\"small_multi\") && length(data) > 1) {\n    df = data %>%\n      group_by(x_axis) %>%\n      summarise_all(list(c(sum = \"sum\"))) %>%\n      pivot_longer(c(-x_axis), names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10),\n      values2 = paste0(as.character(round(values / 1e6, 0)), \"M\"))%>%\n      assign_numeric_order(type_column = type) %>%\n      group_by(x_axis) %>%\n      arrange(x_axis, numeric_order) %>%\n      mutate(sum_values = accumulate(values, ~.x + .y)[numeric_order]) %>%\n      ungroup()\n  } else {\n    df = data.frame()  # or NULL, depending on your use case\n  }\n  return(df)\n}\n\n# Create summary data frames\ndf = create_summary_df(Values)\ndf2 = create_summary_df(Values2)\n\n#Add type for ploting\ndf = df %>%\n  mutate(type2 = \"type1\")\ndf2 = df2 %>%\n  mutate(type2 = \"type2\")\n\n###############Plotting section################\n\n#Collecting wanted labels\ninitialize_columns <- function(str) {\n  df = data.frame(Variable = c(1),\n                  Name = c(2),\n                  placement = 1)\n  for (i in 1:num_cols) {\n    col_name <- paste(str, \"_col\", i, sep = \"\")\n    if (str == \"l\") text_label = paste(\"LowerColumnValue\", i, \"Format_textLabel\", sep = \"\") else text_label = paste(\"UpperColumnValue\", i, \"Format_textLabel\", sep = \"\")\n    if (exists(col_name) && get(text_label) == TRUE) {\n     new_row = c(Variable = colnames(get(col_name)),\n                 Names = col_name,\n                 placement = get(paste(str_split(text_label, \"_\")[[1]][1], \"_labelPlace\", sep = \"\")))\n      df = rbind(df, new_row)\n    }\n  }\n  df = df[-1,]\n  return(df)\n}\nused_labels1 = initialize_columns(\"l\")\nused_labels2 = initialize_columns(\"u\")\nused_labels = rbind(used_labels1, used_labels2)\n\ndf$date_axis = df$newx_axis\ndf2$date_axis = df2$newx_axis\n\nif(any(grepl(\"^(\\\\d{4}\\\\s?[-\\\\s/]\\\\s?[a-zA-Z]{3,}|[a-zA-Z]{3,}\\\\s?[-\\\\s/]\\\\s?\\\\d{4})$\", df$x_axis, perl = TRUE))) {\n\nconvert_to_date <- function(char_vec) {\nif(any(grepl(\"[-]\", char_vec))) {\n  test = paste0(char_vec, \"-01\")\n} else if (any(grepl(\"[/]\", char_vec))) {\n  test = paste0(char_vec, \"/01\")\n} else {\n  test = paste0(char_vec, \" 01\")\n}\n  \ntryCatch(\n  {\n    return(parse_date_time(test, \n        orders = c(\"%Y %b %d\", \"%b %Y %d\",\n                       \"%Y %B %d\", \"%B %Y %d\",\n                       \"%Y-%b-%d\", \"%b-%Y-%d\",\n                       \"%Y-%B-%d\", \"%B-%Y-%d\",\n                       \"%Y - %B-%d\", \"%B - %Y-%d\",\n                       \"%Y - %b-%d\", \"%b - %Y-%d\",                       \n                       \"%Y/%b/%d\", \"%b/%Y/%d\",\n                       \"%Y/%B/%d\", \"%B/%Y/%d\",\n                       \"%Y / %b/%d\", \"%b / %Y/%d\",\n                       \"%Y / %B/%d\", \"%B / %Y/%d\")))                \n},\nerror = function(err) {\n    # If an error occurs with the English date format, try Danish date format\n    danish_date <- tryCatch(\n      {\n        return(parse_date_time(test, \n        orders = c(\"%Y %b %d\", \"%b %Y %d\",\n                       \"%Y %B %d\", \"%B %Y %d\",\n                       \"%Y-%b-%d\", \"%b-%Y-%d\",\n                       \"%Y-%B-%d\", \"%B-%Y-%d\",\n                       \"%Y/%b/%d\", \"%b-%Y/%d\",\n                       \"%Y/%B/%d\", \"%B-%Y/%d\"), locale = \"da\"))             \n      },\n      error = function(danish_err) {\n        cat(\"Error with Danish date format. Both attempts failed.\\n\")\n        return(NULL)  # Handle the case where both attempts fail\n      }\n    )\n  }\n)\n}\n\nif(length(df) > 1){\ndf$date_axis = convert_to_date(df$x_axis)\n}\nif(length(df2) > 1){\ndf2$date_axis = convert_to_date(df2$x_axis)\n}\n}\n\ng <- ggplot() +\n  scale_fill_manual(values = all_colors, name = NULL) +\n  scale_y_continuous(labels = scales::comma_format(big.mark = \".\", decimal.mark = \",\")) +\n  labs(x = mySettingsAxes_x_axis_title, y = mySettingsAxes_y_axis_title)\n\nif(exists(\"small_multi\")) {\n  data_to_use <- if (length(df) == 1) df2 else if (length(df2) == 1) df else merge(df, df2, all = TRUE, by = c(\"newx_axis\", \"values\", \"type\", \"type2\", \"values2\", \"small\", \"numeric_order\", \"sum_values\", \"x_axis\", \"date_axis\"))\n\n  max_value = max(data_to_use$values)\n  combined = merge(x=data_to_use,y=used_labels, \n             by.x= c(\"type\"), by.y = c(\"Variable\"), all.x=TRUE)\n\ncombined_df = combined %>%\n  mutate(sum_values2 = if_else(placement == \"middle\",\n                               sum_values-values*0.5,\n                               if_else(placement == \"on top\",\n                                       sum_values-max_value*-0.02,\n                                       if_else(placement == \"bottom\",\n                                               (sum_values-values)-max_value*-0.02,\n                                               sum_values-max_value*0.04))))\n\n\n  g <- g +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type1\",], \n             aes(x = reorder(newx_axis, date_axis), y = values, fill = type), \n             width = 0.6) +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type2\",], \n             aes(x = reorder(newx_axis, date_axis), y = values, fill = type), \n             width = 0.35)+\n             facet_grid(~small) + ##### Tror alt til small multi format kan lægges her\n             theme(strip.background =element_rect(fill=\"#FFFFFF\"))+\n    geom_text(data = combined_df,\n              aes(x = reorder(newx_axis, date_axis),\n                  y = sum_values2),\n              label = combined_df$values2,\n              inherit.aes = FALSE)\n\n} else {\n  data_to_use <- if (length(df) == 1) df2 else if (length(df2) == 1) df else merge(df, df2, all = TRUE, by = c(\"newx_axis\", \"values\", \"type\", \"type2\", \"values2\", \"numeric_order\", \"sum_values\", \"x_axis\", \"date_axis\"))\n\n  max_value = max(data_to_use$values)\n\n  combined = merge(x=data_to_use,y=used_labels, \n             by.x= c(\"type\"), by.y = c(\"Variable\"), all.x=TRUE)\n\ncombined_df = combined %>%\n  mutate(sum_values2 = if_else(placement == \"middle\",\n                               sum_values-values*0.5,\n                               if_else(placement == \"on top\",\n                                       sum_values-max_value*-0.02,\n                                       if_else(placement == \"bottom\",\n                                               (sum_values-values)-max_value*-0.02,\n                                               sum_values-max_value*0.04))))                                              \n\n  data_to_use$test = data_to_use$values\ndata_to_use$test2 = data_to_use$type\ndata_to_use = pivot_wider(data_to_use, id_cols = c(x_axis, type, values, newx_axis, values2, numeric_order, sum_values, type2, date_axis), names_from = test2, values_from = test)\ndata_to_use[is.na(data_to_use)] <- 0\ntext = str_replace_all(\"Total.Cost\", \"\\\\.\", \" \")\n\n  g <- g +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type1\",], \n             aes(x = reorder(newx_axis, date_axis), y = values, fill = type, text = .data[[text]]), \n             width = 0.6) +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type2\",], \n             aes(x = reorder(newx_axis, date_axis), y = values, fill = type, text = .data[[text]]), \n             width = 0.35) +\n    geom_text(data = combined_df,\n              aes(x = reorder(newx_axis, date_axis),\n                  y = sum_values2),\n              label = combined_df$values2,\n              inherit.aes = FALSE)\n \n}\n\n#################################################### \n\n############# Create and save widget ###############\np = ggplotly(g, tooltip =c(\"y\", \"text\"))%>%\n  layout(plot_bgcolor='#FFFFFF',\n         yaxis = list(gridcolor = \"#F1F2F3\",\n                      gridwidth = 0.1),\n         legend = list(orientation = 'h',\n                       y = 1.1,\n                       font = list(size = 9),\n                       title=list(text='')),\n         hoverlabel = list(align = \"left\")\n  ) %>% \n  config(displayModeBar = F);\n\n\ninternalSaveWidget(p, 'out.html');\n####################################################\n\n################ Reduce paddings ###################\nReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n####################################################"}}}],"objects":{"mySettingsAxes":{"displayName":"Axes and labeling","description":"Axes and labels settings","properties":{"colLabel":{"displayName":"Color of labels","description":"Color of labels","type":{"fill":{"solid":{"color":true}}}},"textSize":{"displayName":"Font size of labels","type":{"numeric":true}},"sizeTicks":{"displayName":"Size ticks","description":"Size ticks","type":{"enumeration":[{"displayName":"None","value":"0"},{"displayName":"4","value":"4"},{"displayName":"6","value":"6"},{"displayName":"8","value":"8"},{"displayName":"10","value":"10"},{"displayName":"12","value":"12"},{"displayName":"14","value":"14"},{"displayName":"16","value":"16"},{"displayName":"18","value":"18"},{"displayName":"20","value":"20"}]}},"axisLine":{"displayName":"Axis line","type":{"bool":true}},"x_axis_title":{"displayName":"X axis title","type":{"text":true}},"y_axis_title":{"displayName":"Y axis title","type":{"text":true}}}},"LowerColumnValue1Format":{"displayName":"Lower column value 1","description":"Lower column value 1 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue2Format":{"displayName":"Lower column value 2","description":"Lower column value 2 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue3Format":{"displayName":"Lower column value 3","description":"Lower column value 3 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue4Format":{"displayName":"Lower column value 4","description":"Lower column value 4 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue5Format":{"displayName":"Lower column value 5","description":"Lower column value 5 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue1Format":{"displayName":"Upper column value 1","description":"Upper column value 1 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue2Format":{"displayName":"Upper column value 2","description":"Upper column value 2 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue3Format":{"displayName":"Upper column value 3","description":"Upper column value 3 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue4Format":{"displayName":"Upper column value 4","description":"Upper column value 4 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue5Format":{"displayName":"Upper column value 5","description":"Upper column value 5 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}}},"suppressDefaultTitle":false},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"xml2","displayName":"xml2","url":"https://cran.r-project.org/web/packages/xml2/index.html"}]},"content":{"js":"var demoCreation522AEF1866B94124B4C4F588A968843A;(()=>{\"use strict\";var e={934:(e,t,s)=>{s.d(t,{Kq:()=>n,ME:()=>l,Tx:()=>a});var r=s(738);let o=0;function a(){o=0}function n(e,t){let s=[];if(!e||!e.hasChildNodes())return;let r=e.children;for(let e=0;e<r.length;e++){let o;o=\"script\"===r.item(e).nodeName.toLowerCase()?i(r.item(e)):r.item(e).cloneNode(!0),t.appendChild(o),s.push(o)}return s}function i(e){let t=document.createElement(\"script\"),s=e.attributes;for(let e=0;e<s.length;e++)t.setAttribute(s[e].name,s[e].textContent),\"src\"===s[e].name.toLowerCase()&&(o++,t.onload=()=>{o--});return t.innerHTML=e.innerHTML,t}function l(){let e=r.setInterval((()=>{0===o&&(r.clearInterval(e),r.hasOwnProperty(\"HTMLWidgets\")&&r.HTMLWidgets.staticRender&&r.HTMLWidgets.staticRender())}),100)}},50:(e,t,s)=>{s.d(t,{Jx:()=>o});var r=s(554).U;class o extends r{constructor(){super(...arguments),this.mySettingsAxes=new n,this.LowerColumnValue1Format=new i,this.LowerColumnValue2Format=new l,this.LowerColumnValue3Format=new c,this.LowerColumnValue4Format=new u,this.LowerColumnValue5Format=new h,this.UpperColumnValue1Format=new d,this.UpperColumnValue2Format=new m,this.UpperColumnValue3Format=new p,this.UpperColumnValue4Format=new b,this.UpperColumnValue5Format=new y,this.rcv_script=new a}}class a{}class n{constructor(){this.colLabel=\"grey\",this.textSize=10,this.sizeTicks=\"8\",this.x_axis_title=\"Nothing at the moment\",this.y_axis_title=\"Nothing at the moment\"}}class i{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class l{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class c{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class u{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class h{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class d{constructor(){this.colLabel=\"#FF0000\",this.textLabel=!1,this.labelPlace=\"none\"}}class m{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class p{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class b{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}class y{constructor(){this.colLabel=\"grey\",this.textLabel=!1,this.labelPlace=\"none\"}}},728:(e,t,s)=>{s.d(t,{u:()=>l});var r,o=s(50),a=s(934),n=s(738);!function(e){e[e.Data=2]=\"Data\",e[e.Resize=4]=\"Resize\",e[e.ViewMode=8]=\"ViewMode\",e[e.Style=16]=\"Style\",e[e.ResizeEnd=32]=\"ResizeEnd\",e[e.All=62]=\"All\"}(r||(r={}));const i=[r.Resize,r.ResizeEnd,r.Resize+r.ResizeEnd];class l{constructor(e){e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}update(e){if(!(e&&e.type&&e.viewport&&e.dataViews&&0!==e.dataViews.length&&e.dataViews[0]))return;const t=e.dataViews[0];this.settings=l.parseSettings(t);let s=null;t.scriptResult&&t.scriptResult.payloadBase64&&(s=t.scriptResult.payloadBase64),-1===i.indexOf(e.type)?s&&this.injectCodeFromPayload(s):this.onResizing(e.viewport)}onResizing(e){}injectCodeFromPayload(e){if((0,a.Tx)(),!e)return;let t=document.createElement(\"html\");try{t.innerHTML=n.atob(e)}catch(e){return}if(0===this.headNodes.length){for(;this.headNodes.length>0;){let e=this.headNodes.pop();document.head.removeChild(e)}let e=t.getElementsByTagName(\"head\");if(e&&e.length>0){let t=e[0];this.headNodes=(0,a.Kq)(t,document.head)}}for(;this.bodyNodes.length>0;){let e=this.bodyNodes.pop();this.rootElement.removeChild(e)}let s=t.getElementsByTagName(\"body\");if(s&&s.length>0){let e=s[0];this.bodyNodes=(0,a.Kq)(e,this.rootElement)}(0,a.ME)()}static parseSettings(e){return o.Jx.parse(e)}enumerateObjectInstances(e){return o.Jx.enumerateObjectInstances(this.settings||o.Jx.getDefault(),e)}}},567:(e,t,s)=>{function r(e,t,s){if(!e)return s;let r=e[t];return void 0===r?s:r}s.d(t,{N:()=>r})},982:(e,t,s)=>{s.d(t,{d9:()=>o});var r=s(567);function o(e,t,s){const o=function(e,t,s){return e?r.N(e[t.objectName],t.propertyName,s):s}(e,t,s);return o&&o.solid?o.solid.color:null==o||\"object\"==typeof o&&!o.solid?s:o}},554:(e,t,s)=>{s.d(t,{U:()=>o});var r=s(982);class o{static getDefault(){return new this}static createPropertyIdentifier(e,t){return{objectName:e,propertyName:t}}static parse(e){let t,s=this.getDefault();if(!e||!e.metadata||!e.metadata.objects)return s;t=s.getProperties();for(let o in t)for(let a in t[o]){const n=s[o][a];s[o][a]=r.d9(e.metadata.objects,t[o][a],n)}return s}static isPropertyEnumerable(e){return!o.InnumerablePropertyPrefix.test(e)}static enumerateObjectInstances(e,t){let s=e&&e[t.objectName];if(!s)return[];let r={objectName:t.objectName,selector:null,properties:{}};for(let e in s)s.hasOwnProperty(e)&&(r.properties[e]=s[e]);return{instances:[r]}}getProperties(){let e={};return Object.keys(this).forEach((t=>{if(o.isPropertyEnumerable(t)){let s=Object.keys(this[t]);e[t]={},s.forEach((s=>{o.isPropertyEnumerable(t)&&(e[t][s]=o.createPropertyIdentifier(t,s))}))}})),e}}o.InnumerablePropertyPrefix=/^_/},738:e=>{e.exports=Function(\"return this\")()}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var r={};(()=>{s.r(r),s.d(r,{default:()=>a});var e=s(728),t=s(738).powerbi,o={name:\"demoCreation522AEF1866B94124B4C4F588A968843A\",displayName:\"demoCreation\",class:\"Visual\",apiVersion:\"3.8.0\",create:t=>{if(e.u)return new e.u(t);throw\"Visual instance not found\"},createModalDialog:(e,t,s)=>{const r=globalThis.dialogRegistry;e in r&&new r[e](t,s)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.demoCreation522AEF1866B94124B4C4F588A968843A=o);const a=o})(),demoCreation522AEF1866B94124B4C4F588A968843A=r})();","css":"","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":"","toolsVersion":null}