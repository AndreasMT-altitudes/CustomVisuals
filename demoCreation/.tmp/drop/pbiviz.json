{"visual":{"name":"demoCreation","displayName":"Overlayering Stacked Column chart","guid":"demoCreation522AEF1866B94124B4C4F588A968843A","visualClassName":"Visual","version":"1.0.0.0","description":"Demo","supportUrl":"Demo.dk","gitHubUrl":""},"author":{"name":"Andreas Methling","email":"andreas.methling@gmail.com"},"apiVersion":"3.8.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Category","description":"Category to show on the x_axis","name":"category","kind":"Grouping"},{"displayName":"Lower column value 1","name":"l_col1","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 2","name":"l_col2","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 3","name":"l_col3","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 4","name":"l_col4","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 5","name":"l_col5","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 1","name":"u_col1","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 2","name":"u_col2","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 3","name":"u_col3","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 4","name":"u_col4","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 5","name":"u_col5","kind":"GroupingOrMeasure"},{"displayName":"Small Multiple","name":"small_multi","kind":"GroupingOrMeasure"}],"dataViewMappings":[{"conditions":[{"category":{"max":1},"l_col1":{"max":1},"l_col2":{"min":0,"max":1},"l_col3":{"min":0,"max":1},"l_col4":{"min":0,"max":1},"l_col5":{"min":0,"max":1},"u_col1":{"max":1},"u_col2":{"min":0,"max":1},"u_col3":{"min":0,"max":1},"u_col4":{"min":0,"max":1},"u_col5":{"min":0,"max":1},"small_multi":{"min":0,"max":1}}],"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"category"}},{"for":{"in":"l_col1"}},{"for":{"in":"l_col2"}},{"for":{"in":"l_col3"}},{"for":{"in":"l_col4"}},{"for":{"in":"l_col5"}},{"for":{"in":"u_col1"}},{"for":{"in":"u_col2"}},{"for":{"in":"u_col3"}},{"for":{"in":"u_col4"}},{"for":{"in":"u_col5"}},{"for":{"in":"small_multi"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"############### Utility functions ###############\r\nlibraryRequireInstall = function(packageName, ...)\r\n{\r\n  if(!require(packageName, character.only = TRUE)) \r\n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\r\n}\r\n\r\nlibraryRequireInstall(\"xml2\")\r\nlibraryRequireInstall(\"htmlwidgets\")\r\n\r\ninternalSaveWidget <- function(widget, fname)\r\n{\r\n  tempFname = paste(fname, \".tmp\", sep=\"\")\r\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\r\n  FlattenHTML(tempFname, fname)\r\n}\r\n\r\nFlattenHTML <- function(fnameIn, fnameOut)\r\n{\r\n  # Read and parse HTML file\r\n  # Embed all js and css files into one unified file\r\n  \r\n  if(!file.exists(fnameIn))\r\n    return(FALSE)\r\n  \r\n  dir = dirname(fnameIn)\r\n  html = read_html(fnameIn, useInternal = TRUE)\r\n  top = xml_root(html)\r\n  \r\n  # extract all <script> tags with src value\r\n  srcNode=xml_find_all(top, '//script[@src]')\r\n  for (node in srcNode)\r\n  {\r\n    b = xml_attrs(node)\r\n    fname = file.path(dir, b['src'])\r\n    alternateSrc = FindSrcReplacement(fname)\r\n    if (!is.null(alternateSrc))\r\n    {\r\n      s = alternateSrc\r\n      names(s) = 'src'\r\n      newNode = xml_new_root(\"script\")\r\n      xml_set_attrs(newNode, s)\r\n      xml_replace(node, newNode)\r\n    }else{\r\n      str=ReadFileForEmbedding(fname);\r\n      if (!is.null(str))\r\n      {      \r\n        newNode = xml_new_root(\"script\",str)\r\n        xml_set_attrs( newNode, c( type = \"text/javascript\") )\r\n        xml_replace(node, newNode)\r\n      }\r\n    }\r\n  }\r\n  \r\n  # extract all <link> tags with src value\r\n  linkNode=xml_find_all(top, '//link[@href]')\r\n  for (node in linkNode)\r\n  {\r\n    b = xml_attrs(node)\r\n    fname = file.path(dir, b['href'])\r\n    str = ReadFileForEmbedding(fname, FALSE);\r\n    if (!is.null(str))\r\n    {\r\n      newNode = xml_new_root(\"style\", str)\r\n      xml_replace(node, newNode)\r\n    }\r\n  }\r\n  \r\n  write_xml(html, file = fnameOut)\r\n  return(TRUE)\r\n}\r\n\r\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\r\n{\r\n  data = ReadFullFile(fname)\r\n  if (is.null(data))\r\n    return(NULL)\r\n\r\n  str = paste(data, collapse ='\\n')\r\n  if (addCdata) {\r\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\r\n  }\r\n  return(str)\r\n}\r\n\r\nReadFullFile <- function(fname)\r\n{\r\n  if(!file.exists(fname))\r\n    return(NULL)\r\n  \r\n  con = file(fname, open = \"r\")\r\n  data = readLines(con)\r\n  close(con)\r\n  return(data)\r\n}\r\n\r\nFindSrcReplacement <- function(str)\r\n{\r\n  # finds reference to 'plotly' js and replaces with a version from CDN\r\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\r\n  str <- iconv(str, to=\"UTF-8\")\r\n  pattern = \"plotly-(\\\\w.+)/plotly-latest.min.js\"\r\n  match1=regexpr(pattern, str)\r\n  attr(match1, 'useBytes') <- FALSE\r\n  strMatch=regmatches(str, match1, invert = FALSE)\r\n  if (length(strMatch) == 0) return(NULL)\r\n  \r\n  pattern2 = \"-(\\\\d.+)/\"\r\n  match2 = regexpr(pattern2, strMatch[1])\r\n  attr(match2, 'useBytes') <- FALSE\r\n  strmatch = regmatches(strMatch[1], match2)\r\n  if (length(strmatch) == 0) return(NULL)\r\n  \r\n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\r\n  # This matches the specific version used in the plotly package used.\r\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\r\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\r\n  return(str)\r\n}\r\n\r\nReadFullFileReplaceString <- function(fnameIn, fnameOut, sourceString,targetString) {\r\n  # Replaces texts in file\r\n  # This makes it possible to replace e.g. paddings in the generated html widget code\r\n  if(!file.exists(fnameIn))\r\n    return(NULL)\r\n  tx  <- readLines(fnameIn,encoding = \"UTF-8\")\r\n  tx2  <- gsub(pattern = sourceString, replace = targetString, x = tx)\r\n  writeLines(tx2, con = fnameOut)\r\n}\r\n#################################################\r\n\n\n############### Library Declarations ###############\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"ggplot2\")));\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"plotly\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"tidyverse\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"scales\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"tsibble\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"lubridate\")))\n####################################################\n\n################### Actual code ####################\n###################Dealing with errors##############\nif(!exists(\"category\")) {\n  errorText <- \"There needs to be a categorical column\n                </br> in the Category field\"\n  g = ggplot() + geom_text(aes(x = 0.5, y = 0.5, label = errorText), size = 5) +\n    theme(\n      axis.title.x = element_blank(),\n      axis.text.x = element_blank(),\n      axis.ticks.x = element_blank(),\n      axis.title.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.ticks.y = element_blank()\n    )\n  p = ggplotly(g) %>%\n    layout(plot_bgcolor='#FFFFFF',\n           yaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE),\n           xaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE))\n  internalSaveWidget(p, 'out.html')\n  ReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n  quit()                       \n}\n\n###########Settings defualt values for formating options############\nnum_cols <- 5\n\n##Setting Labels to True in the enviroment, if nothing is supplied\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"LowerColumnValue\", i, \"Format_textLabel\")\n  if (!exists(label_name)) {\n    assign(label_name, FALSE, envir = .GlobalEnv)\n  }\n}\n\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"UpperColumnValue\", i, \"Format_textLabel\")\n  if (!exists(label_name)) {\n    assign(label_name, FALSE, envir = .GlobalEnv)\n  }\n}\n\n\n##Setting label placement to default values if nothing else is supplied\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"LowerColumnValue\", i, \"Format_labelPlace\")\n  if (!exists(label_name)) {\n    assign(label_name, \"top\", envir = .GlobalEnv)\n  }\n}\n\nfor (i in 1:num_cols) {\n  label_name <- paste0(\"UpperColumnValue\", i, \"Format_labelPlace\")\n  if (!exists(label_name)) {\n    assign(label_name, \"top\", envir = .GlobalEnv)\n  }\n}\n\n##########Bar Settings###################\nif (!exists(\"BarSettings_textSize\")) {\n  BarSettings_textSize = 12/4\n} else {\n  BarSettings_textSize = as.numeric(BarSettings_textSize)/4\n}\n\nif (!exists(\"BarSettings_colLabel\")) {\n  BarSettings_colLabel = \"black\"\n}\n\nif (!exists(\"BarSettings_LBarSize\")) {\n  BarSettings_LBarSize = 0.6\n} else {\n   as.numeric(BarSettings_LBarSize)\n}\n\nif (!exists(\"BarSettings_UBarSize\")) {\n  BarSettings_UBarSize = 0.35\n} else {\n   as.numeric(BarSettings_UBarSize)\n}\n\n\n##########Axes Settings###################\nif (!exists(\"mySettingsAxes_x_axis_title\")) {\n  mySettingsAxes_x_axis_title = \"\"\n}\n\nif (!exists(\"mySettingsAxes_y_axis_title\")) {\n  mySettingsAxes_y_axis_title = \"\"\n}\n\nif (!exists(\"mySettingsAxes_x_axis_textSize\")) {\n mySettingsAxes_x_axis_textSize = 8\n}\n\nif (!exists(\"mySettingsAxes_y_axis_textSize\")) {\n mySettingsAxes_y_axis_textSize = 8\n}\n\nif (!exists(\"mySettingsAxes_x_axis_textRotate\")) {\n mySettingsAxes_x_axis_textRotate = 0\n} else {\n    mySettingsAxes_x_axis_textRotate = as.numeric(mySettingsAxes_x_axis_textRotate)\n}\n\n\n\n\nupdate_geom_defaults(\"text\", list(size = BarSettings_textSize, color = BarSettings_colLabel)) ##sæt nu genereal size her\n\n#############Create Values- dataset from user selected fields####################\n# Set the number of columns\n\ncategory[] <- lapply(category[1], as.character)\n\nValues <- data.frame(category)\nValues2 <- data.frame(category)\n\ninitialize_data_frame <- function(df, str) {\n  if (exists(\"small_multi\")) {\n    small_multi[] <- lapply(small_multi[1], as.character)\n    df <- data.frame(category, small_multi)\n    colnames(df)[length(df)] <- \"small\"\n  }\n\n  for (i in 1:num_cols) {\n    col_name <- paste(str, \"_col\", i, sep = \"\")\n    if (exists(\"category\") && exists(col_name)) {\n      df[[col_name]] <- get(col_name)\n      if(str == \"l\"){\n        test = \"Lower\"\n    } else {\n      test = \"Upper\"\n    }\n      if(exists(paste0(test ,\"ColumnValue\", i, \"Format_Name\"))){\n        if(paste0(test ,\"ColumnValue\", i, \"Format_Name\") == \"\"){\n          colnames(df)[length(df)] <- colnames(get(col_name))\n      } else {\n          colnames(df)[length(df)] <- get(paste0(test ,\"ColumnValue\", i, \"Format_Name\"))\n        }\n      } \n      else{\n      colnames(df)[length(df)] <- colnames(get(col_name))\n      }\n    }\n  }\n  return(df)\n}\n\nValues <- initialize_data_frame(Values, \"l\")\nValues2 <- initialize_data_frame(Values2, \"u\")\n\n\n#######Color Specefications\ndefault_labels <- c(\"#9e7e38\", \"#59786c\", \"#82231c\", \"#511536\", \"#443e67\", \"#375669\", \"#456525\", \"#000000\", \"#3d3c1d\", \"#625750\")\ncolors = c()\ncolors2 = c()\n\ncolors <- lapply(1:num_cols, function(i) {\n  label_name <- paste(\"LowerColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  label_name2 <- paste(\"LowerColumnValue\", i, \"Format_Name\", sep = \"\")\n  col_name <- paste(\"l_col\", i, sep = \"\")\n\n  if(exists(label_name2) && get(label_name2) != \"\") {\n    if (!exists(label_name) && exists(col_name)) {\n      col_vec = c()\n      name = get(label_name2)\n      col_vec[name] = default_labels[i]\n      value = col_vec[name]\n      return(col_vec)\n    } else if (exists(label_name) && exists(col_name)) {\n      col_vec = c()\n      name = get(label_name2)\n      col_vec[name] = get(label_name)\n      value = col_vec[name]\n      return(value)\n    } \n  } else {\n    if (!exists(label_name) && exists(col_name)) {\n      col_vec = c()\n      name = colnames(get(col_name))\n      col_vec[name] = default_labels[i]\n      value = col_vec[name]\n      return(col_vec)\n    } else if (exists(label_name) && exists(col_name)) {\n      col_vec = c()\n      name = colnames(get(col_name))\n      col_vec[name] = get(label_name)\n      value = col_vec[name]\n      return(value)\n    }\n\n  }\n})\n\ncolors2 <- lapply(1:num_cols, function(i) {\n  label_name <- paste(\"UpperColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  label_name2 <- paste(\"UpperColumnValue\", i, \"Format_Name\", sep = \"\")\n  col_name <- paste(\"u_col\", i, sep = \"\")\n  label <- 5 + i\n  if (!exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = default_labels[label]\n    value = col_vec[name]\n    return(col_vec)\n  } else if (exists(label_name) && exists(col_name)) {\n    col_vec = c()\n    name = colnames(get(col_name))\n    col_vec[name] = get(label_name)\n    value = col_vec[name]\n    return(value)\n  }\n})\n\nall_colors <- unlist(c(colors, colors2))\n\n###########Transforming Dataframe###############\ncolnames(Values)[1] = \"x_axis\"\ncolnames(Values2)[1] = \"x_axis\"\n\n\n#Function to make alphabetical order of columns\nassign_numeric_order <- function(data, type_column) {\n  data %>%\n    mutate(numeric_order = match({{type_column}}, rev(sort(unique({{type_column}})))))\n}\n\ntest = sum(data.frame(group_by(Values, x_axis) %>% summarise_all(list(c(sum =\"sum\"))))[2]) ## Lav til en funktion og fiks det\n\n# Function to create summary data frame\ncreate_summary_df <- function(data) {\n  if (exists(\"small_multi\") && length(data) > 2) {\n    df = data %>%\n      group_by(x_axis, small) %>%\n      summarise_all(list(c(sum = \"sum\"))) %>%\n      pivot_longer(c(-x_axis, -small), names_to = \"type\", values_to = \"values\") %>%\n      assign_numeric_order(type_column = type) %>%\n      group_by(x_axis, small) %>%\n      arrange(x_axis,small, numeric_order) %>%\n      mutate(sum_values = accumulate(coalesce(values, 0), ~.x + .y)[numeric_order]) %>%\n      ungroup()\n  } else if (!exists(\"small_multi\") && length(data) > 1) {\n    df = data %>%\n      group_by(x_axis) %>%\n      summarise_all(list(c(sum = \"sum\"))) %>%\n      pivot_longer(c(-x_axis), names_to = \"type\", values_to = \"values\") %>%\n      assign_numeric_order(type_column = type) %>%\n      group_by(x_axis) %>%\n      arrange(x_axis, numeric_order) %>%\n      mutate(sum_values = accumulate(coalesce(values, 0), ~.x + .y)[numeric_order]) %>%\n      ungroup()\n  } else {\n    df = data.frame()  # or NULL, depending on your use case\n  }\n  return(df)\n}\n\n# Create summary data frames\ndf = create_summary_df(Values)\ndf2 = create_summary_df(Values2)\n\n#Add type for ploting\ndf = df %>%\n  mutate(type2 = \"type1\")\ndf2 = df2 %>%\n  mutate(type2 = \"type2\")\n\n###############Plotting section################\n\n#Collecting wanted labels\ninitialize_columns <- function(str) {\n  df = data.frame(Variable = c(1),\n                  Name = c(2),\n                  placement = 1)\n  for (i in 1:num_cols) {\n    col_name <- paste(str, \"_col\", i, sep = \"\")\n    if (str == \"l\") text_label = paste(\"LowerColumnValue\", i, \"Format_textLabel\", sep = \"\") else text_label = paste(\"UpperColumnValue\", i, \"Format_textLabel\", sep = \"\")\n    if (exists(col_name) && get(text_label) == TRUE) {\n     new_row = c(Variable = colnames(get(col_name)),\n                 Names = col_name,\n                 placement = get(paste(str_split(text_label, \"_\")[[1]][1], \"_labelPlace\", sep = \"\")))\n      df = rbind(df, new_row)\n    }\n  }\n  df = df[-1,]\n  return(df)\n}\nused_labels1 = initialize_columns(\"l\")\nused_labels2 = initialize_columns(\"u\")\nused_labels = rbind(used_labels1, used_labels2)\n\ndf$date_axis = df$x_axis\ndf2$date_axis = df2$x_axis\n\nif(any(grepl(\"^(\\\\d{4}\\\\s?[-\\\\s/]\\\\s?[a-zA-Z]{3,}|[a-zA-Z]{3,}\\\\s?[-\\\\s/]\\\\s?\\\\d{4})$\", df$x_axis, perl = TRUE))) {\n\nconvert_to_date <- function(char_vec) {\nif(any(grepl(\"[-]\", char_vec))) {\n  test = paste0(char_vec, \"-01\")\n} else if (any(grepl(\"[/]\", char_vec))) {\n  test = paste0(char_vec, \"/01\")\n} else {\n  test = paste0(char_vec, \" 01\")\n}\n  \ntryCatch(\n  {\n    return(parse_date_time(test, \n        orders = c(\"%Y %b %d\", \"%b %Y %d\",\n                       \"%Y %B %d\", \"%B %Y %d\",\n                       \"%Y-%b-%d\", \"%b-%Y-%d\",\n                       \"%Y-%B-%d\", \"%B-%Y-%d\",\n                       \"%Y - %B-%d\", \"%B - %Y-%d\",\n                       \"%Y - %b-%d\", \"%b - %Y-%d\",                       \n                       \"%Y/%b/%d\", \"%b/%Y/%d\",\n                       \"%Y/%B/%d\", \"%B/%Y/%d\",\n                       \"%Y / %b/%d\", \"%b / %Y/%d\",\n                       \"%Y / %B/%d\", \"%B / %Y/%d\")))                \n},\nerror = function(err) {\n    # If an error occurs with the English date format, try Danish date format\n    danish_date <- tryCatch(\n      {\n        return(parse_date_time(test, \n        orders = c(\"%Y %b %d\", \"%b %Y %d\",\n                       \"%Y %B %d\", \"%B %Y %d\",\n                       \"%Y-%b-%d\", \"%b-%Y-%d\",\n                       \"%Y-%B-%d\", \"%B-%Y-%d\",\n                       \"%Y/%b/%d\", \"%b-%Y/%d\",\n                       \"%Y/%B/%d\", \"%B-%Y/%d\"), locale = \"da\"))             \n      },\n      error = function(danish_err) {\n        cat(\"Error with Danish date format. Both attempts failed.\\n\")\n        return(NULL)  # Handle the case where both attempts fail\n      }\n    )\n  }\n)\n}\n\nif(length(df) > 1){\ndf$date_axis = convert_to_date(df$x_axis)\n}\nif(length(df2) > 1){\ndf2$date_axis = convert_to_date(df2$x_axis)\n}\n}\n\nmax = max(rbind(df, df2)$sum_values, na.rm = TRUE)\nunit = ifelse(max > 1000000000000, \"bio.\", ifelse(max > 1000000000, \"mia.\", ifelse(max > 1000000, \"mio.\", ifelse(max > 1000, \"tus.\", \"\"))))\nscale = ifelse(max > 1000000000000, 1e-12, ifelse(max > 1000000000, 1e-9, ifelse(max > 1000000, 1e-6, ifelse(max > 1000, 1e-3, \"\"))))\n\ng <- ggplot() +\n  scale_fill_manual(values = all_colors, name = NULL) +\n  scale_y_continuous(labels = unit_format(unit = unit, scale = scale)) +\n  labs(x = mySettingsAxes_x_axis_title, y = mySettingsAxes_y_axis_title) + \n  theme(axis.text.x = element_text(size = mySettingsAxes_x_axis_textSize, angle = mySettingsAxes_x_axis_textRotate),\n        axis.text.y = element_text(size = mySettingsAxes_y_axis_textSize))\n\nif(!exists(\"BarSettings_decimal\")){\n  BarSettings_decimal = 0\n}\nBarSettings_decimal = as.numeric(BarSettings_decimal)\n\nif (exists(\"BarSettings_unitLabel\")) {\n  if(BarSettings_unitLabel == \"auto\") {\n\n  } else{\n  unit = BarSettings_unitLabel\n\n    if(unit == \"tus.\") {\n      scale = 1e-3\n    } else if(unit == \"mio.\") {\n      scale = 1e-6\n    } else if(unit == \"mia.\") {\n      scale = 1e-9\n    } else if(unit == \"bio.\") {\n      scale = 1e-12\n    }\n\n  } \n}\n\n\nif(length(df) > 1){\n  df = df %>%\n    mutate(values2 = ifelse(is.na(values), paste0(\"0\", unit), paste0(as.character(round(values*scale, BarSettings_decimal)), unit))) \n}\n\nif(length(df2) > 1){\n  df2 = df2 %>%\n    mutate(values2 = ifelse(is.na(values), paste0(\"0\", unit), paste0(as.character(round(values*scale, BarSettings_decimal)), unit))) \n}\n\nif(exists(\"small_multi\")) {\n  data_to_use <- if (length(df) == 1) df2 else if (length(df2) == 1) df else merge(df, df2, all = TRUE, by = c(\"values\", \"type\", \"type2\", \"values2\", \"small\", \"numeric_order\", \"sum_values\", \"x_axis\", \"date_axis\"))\n\n  max_value = max(data_to_use$values, na.rm = TRUE)\n  combined = merge(x=data_to_use,y=used_labels, \n             by.x= c(\"type\"), by.y = c(\"Variable\"), all.x=TRUE)\n\ncombined_df = combined %>%\n  mutate(sum_values2 = if_else(placement == \"middle\",\n                               sum_values-values*0.5,\n                               if_else(placement == \"on top\",\n                                       sum_values-max_value*-0.02,\n                                       if_else(placement == \"bottom\",\n                                               (sum_values-values)-max_value*-0.02,\n                                               sum_values-max_value*0.04))))\n\ndata_to_use[is.na(data_to_use)] <- 0\n\ndata_to_use1 = data_to_use %>% select(c(type, values, numeric_order, type2))\n\nformatted_vector1 <- apply(data_to_use1[data_to_use1$type2 == \"type1\",], 1, function(row) {\n  paste0(row[1], \": \", row[2])\n})\n\nformatted_vector2 <- apply(data_to_use1[data_to_use1$type2 == \"type2\",], 1, function(row) {\n  paste0(row[1], \": \", row[2])\n})\n\n  g <- g +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type1\",], \n             aes(x = reorder(x_axis, date_axis), y = values, fill = type, text = formatted_vector1), \n             width = BarSettings_LBarSize) +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type2\",], \n             aes(x = reorder(x_axis, date_axis), y = values, fill = type, text = formatted_vector2), \n             width = BarSettings_UBarSize)+\n             facet_grid(~small) + ##### Tror alt til small multi format kan lægges her\n             theme(strip.background =element_rect(fill=\"#FFFFFF\"))+\n    geom_text(data = combined_df,\n              aes(x = reorder(x_axis, date_axis),\n                  y = sum_values2),\n              label = combined_df$values2,\n              inherit.aes = FALSE)\n\n} else {\n  data_to_use <- if (length(df) == 1) df2 else if (length(df2) == 1) df else merge(df, df2, all = TRUE, by = c(\"x_axis\", \"values\", \"type\", \"type2\", \"values2\", \"numeric_order\", \"sum_values\", \"x_axis\", \"date_axis\"))\n\n  max_value = max(data_to_use$values, na.rm = TRUE)\n\n  combined = merge(x=data_to_use,y=used_labels, \n             by.x= c(\"type\"), by.y = c(\"Variable\"), all.x=TRUE)\n\ncombined_df = combined %>%\n  mutate(sum_values2 = if_else(placement == \"middle\",\n                               sum_values-values*0.5,\n                               if_else(placement == \"on top\",\n                                       sum_values-max_value*-0.02,\n                                       if_else(placement == \"bottom\",\n                                               (sum_values-values)-max_value*-0.02,\n                                               sum_values-max_value*0.04))))                                              \n\ndata_to_use[is.na(data_to_use)] <- 0\n\ndata_to_use1 = data_to_use %>% select(c(type, values, numeric_order, type2))\n\nformatted_vector1 <- apply(data_to_use1[data_to_use1$type2 == \"type1\",], 1, function(row) {\n  paste0(row[1], \": \", row[2])\n})\n\nformatted_vector2 <- apply(data_to_use1[data_to_use1$type2 == \"type2\",], 1, function(row) {\n  paste0(row[1], \": \", row[2])\n})\n\n  g <- g +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type1\",], \n             aes(x = reorder(x_axis, date_axis), y = values, fill = type, text = formatted_vector1), \n             width = BarSettings_LBarSize) +\n    geom_col(data = data_to_use[data_to_use$type2 == \"type2\",], \n             aes(x = reorder(x_axis, date_axis), y = values, fill = type, text = formatted_vector2), \n             width = BarSettings_UBarSize) +\n    geom_text(data = combined_df,\n              aes(x = reorder(x_axis, date_axis),\n                  y = sum_values2),\n              label = combined_df$values2,\n              inherit.aes = FALSE)\n \n}\n\n####################################################\n\n############# Create and save widget ###############\np = ggplotly(g, tooltip = c(\"text\"))%>%\n  layout(plot_bgcolor='#FFFFFF',\n         yaxis = list(gridcolor = \"#F1F2F3\",\n                      gridwidth = 0.1),\n         legend = list(orientation = 'h',\n                       y = 1.1,\n                       font = list(size = 9),\n                       title=list(text='')),\n         hoverlabel = list(align = \"left\")\n  ) %>% \n  config(displayModeBar = F);\n\n\ninternalSaveWidget(p, 'out.html');\n####################################################\n\n################ Reduce paddings ###################\nReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n####################################################\n\n"}}}],"objects":{"mySettingsAxes":{"displayName":"Axes settings","description":"Axes settings","properties":{"axisLine":{"displayName":"Axis line","type":{"bool":true}},"x_axis_title":{"displayName":"X axis title","type":{"text":true}},"x_axis_textSize":{"displayName":"X axis text size","type":{"text":true}},"x_axis_textRotate":{"displayName":"X axis text rotation degrees","type":{"enumeration":[{"displayName":"0","value":"0"},{"displayName":"10","value":"10"},{"displayName":"20","value":"20"},{"displayName":"45","value":"45"},{"displayName":"90","value":"90"},{"displayName":"270","value":"270"}]}},"y_axis_title":{"displayName":"Y axis title","type":{"text":true}},"y_axis_textSize":{"displayName":"Y axis text size","type":{"text":true}}}},"BarSettings":{"displayName":"General bar settings","description":"General bar settings and labelling","properties":{"colLabel":{"displayName":"Color of labels","description":"Color of labels","type":{"fill":{"solid":{"color":true}}}},"unitLabel":{"displayName":"Unit","type":{"enumeration":[{"displayName":"auto","value":"auto"},{"displayName":"tus.","value":"tus."},{"displayName":"mio.","value":"mio."},{"displayName":"mia.","value":"mia."},{"displayName":"bio","value":"bio"}]}},"decimal":{"displayName":"Number of decimals","type":{"enumeration":[{"displayName":"0","value":"0"},{"displayName":"1","value":"1"},{"displayName":"2","value":"2"},{"displayName":"3","value":"3"},{"displayName":"4","value":"4"}]}},"textSize":{"displayName":"Font size of labels","type":{"enumeration":[{"displayName":"6","value":"6"},{"displayName":"8","value":"8"},{"displayName":"10","value":"10"},{"displayName":"12","value":"12"},{"displayName":"14","value":"14"},{"displayName":"16","value":"16"},{"displayName":"18","value":"18"},{"displayName":"20","value":"20"}]}},"LBarSize":{"displayName":"Width og lower columns","type":{"enumeration":[{"displayName":"0.2","value":"0.2"},{"displayName":"0.25","value":"0.25"},{"displayName":"0.3","value":"0.3"},{"displayName":"0.35","value":"0.35"},{"displayName":"0.4","value":"0.4"},{"displayName":"0.45","value":"0.45"},{"displayName":"0.5","value":"0.5"},{"displayName":"0.55","value":"0.55"},{"displayName":"0.6","value":"0.6"},{"displayName":"0.65","value":"0.65"},{"displayName":"0.7","value":"0.7"},{"displayName":"0.75","value":"0.75"},{"displayName":"0.8","value":"0.8"},{"displayName":"0.85","value":"0.85"},{"displayName":"0.9","value":"0.9"},{"displayName":"0.95","value":"0.95"},{"displayName":"1","value":"1"}]}},"UBarSize":{"displayName":"Width of upper bar","type":{"enumeration":[{"displayName":"0.05","value":"0.05"},{"displayName":"0.1","value":"0.1"},{"displayName":"0.15","value":"0.15"},{"displayName":"0.2","value":"0.2"},{"displayName":"0.25","value":"0.25"},{"displayName":"0.3","value":"0.3"},{"displayName":"0.35","value":"0.35"},{"displayName":"0.4","value":"0.4"},{"displayName":"0.45","value":"0.45"},{"displayName":"0.5","value":"0.5"},{"displayName":"0.55","value":"0.55"},{"displayName":"0.6","value":"0.6"},{"displayName":"0.65","value":"0.65"},{"displayName":"0.7","value":"0.7"},{"displayName":"0.75","value":"0.75"},{"displayName":"0.8","value":"0.8"},{"displayName":"0.85","value":"0.85"}]}}}},"LowerColumnValue1Format":{"displayName":"Lower column value 1","description":"Lower column value 1 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue2Format":{"displayName":"Lower column value 2","description":"Lower column value 2 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue3Format":{"displayName":"Lower column value 3","description":"Lower column value 3 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue4Format":{"displayName":"Lower column value 4","description":"Lower column value 4 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"LowerColumnValue5Format":{"displayName":"Lower column value 5","description":"Lower column value 5 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue1Format":{"displayName":"Upper column value 1","description":"Upper column value 1 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue2Format":{"displayName":"Upper column value 2","description":"Upper column value 2 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue3Format":{"displayName":"Upper column value 3","description":"Upper column value 3 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue4Format":{"displayName":"Upper column value 4","description":"Upper column value 4 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"UpperColumnValue5Format":{"displayName":"Upper column value 5","description":"Upper column value 5 settings","properties":{"Name":{"displayName":"Variable Name","description":"Name of variable","type":{"text":true}},"colLabel":{"displayName":"Color of bar","description":"color of bar","type":{"fill":{"solid":{"color":true}}}},"textLabel":{"displayName":"Label","type":{"bool":true}},"labelPlace":{"displayName":"Label placement","description":"Label placement","type":{"enumeration":[{"displayName":"Top","value":"top"},{"displayName":"On top","value":"on top"},{"displayName":"Middle","value":"middle"},{"displayName":"Bottom","value":"bottom"}]}}}},"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}}},"suppressDefaultTitle":false},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"xml2","displayName":"xml2","url":"https://cran.r-project.org/web/packages/xml2/index.html"}]},"content":{"js":"var demoCreation522AEF1866B94124B4C4F588A968843A;(()=>{\"use strict\";var e={830:(e,t,s)=>{s.d(t,{Kq:()=>o,ME:()=>l,Tx:()=>i});var a=s(738);let r=0;function i(){r=0}function o(e,t){let s=[];if(!e||!e.hasChildNodes())return;let a=e.children;for(let e=0;e<a.length;e++){let r;r=\"script\"===a.item(e).nodeName.toLowerCase()?n(a.item(e)):a.item(e).cloneNode(!0),t.appendChild(r),s.push(r)}return s}function n(e){let t=document.createElement(\"script\"),s=e.attributes;for(let e=0;e<s.length;e++)t.setAttribute(s[e].name,s[e].textContent),\"src\"===s[e].name.toLowerCase()&&(r++,t.onload=()=>{r--});return t.innerHTML=e.innerHTML,t}function l(){let e=a.setInterval((()=>{0===r&&(a.clearInterval(e),a.hasOwnProperty(\"HTMLWidgets\")&&a.HTMLWidgets.staticRender&&a.HTMLWidgets.staticRender())}),100)}},539:(e,t,s)=>{s.d(t,{Jx:()=>r});var a=s(554).U;class r extends a{constructor(){super(...arguments),this.mySettingsAxes=new o,this.BarSettings=new n,this.LowerColumnValue1Format=new l,this.LowerColumnValue2Format=new c,this.LowerColumnValue3Format=new u,this.LowerColumnValue4Format=new h,this.LowerColumnValue5Format=new d,this.UpperColumnValue1Format=new m,this.UpperColumnValue2Format=new p,this.UpperColumnValue3Format=new b,this.UpperColumnValue4Format=new f,this.UpperColumnValue5Format=new y,this.rcv_script=new i}}class i{}class o{constructor(){this.x_axis_title=\"\",this.x_axis_textSize=8,this.x_axis_textRotate=\"0\",this.y_axis_title=\"\",this.y_axis_textSize=8}}class n{constructor(){this.colLabel=\"grey\",this.unitLabel=\"auto\",this.decimal=\"0\",this.textSize=\"12\",this.LBarSize=\"0.6\",this.UBarSize=\"0.35\"}}class l{constructor(){this.Name=\"\",this.colLabel=\"#9e7e38\",this.textLabel=!1,this.labelPlace=\"none\"}}class c{constructor(){this.Name=\"\",this.colLabel=\"#59786c\",this.textLabel=!1,this.labelPlace=\"none\"}}class u{constructor(){this.Name=\"\",this.colLabel=\"#82231c\",this.textLabel=!1,this.labelPlace=\"none\"}}class h{constructor(){this.Name=\"\",this.colLabel=\"#511536\",this.textLabel=!1,this.labelPlace=\"none\"}}class d{constructor(){this.Name=\"\",this.colLabel=\"#443e67\",this.textLabel=!1,this.labelPlace=\"none\"}}class m{constructor(){this.Name=\"\",this.colLabel=\"#375669\",this.textLabel=!1,this.labelPlace=\"none\"}}class p{constructor(){this.Name=\"\",this.colLabel=\"#456525\",this.textLabel=!1,this.labelPlace=\"none\"}}class b{constructor(){this.Name=\"\",this.colLabel=\"#000000\",this.textLabel=!1,this.labelPlace=\"none\"}}class f{constructor(){this.Name=\"\",this.colLabel=\"#3d3c1d\",this.textLabel=!1,this.labelPlace=\"none\"}}class y{constructor(){this.Name=\"\",this.colLabel=\"#625750\",this.textLabel=!1,this.labelPlace=\"none\"}}},699:(e,t,s)=>{s.d(t,{u:()=>l});var a,r=s(539),i=s(830),o=s(738);!function(e){e[e.Data=2]=\"Data\",e[e.Resize=4]=\"Resize\",e[e.ViewMode=8]=\"ViewMode\",e[e.Style=16]=\"Style\",e[e.ResizeEnd=32]=\"ResizeEnd\",e[e.All=62]=\"All\"}(a||(a={}));const n=[a.Resize,a.ResizeEnd,a.Resize+a.ResizeEnd];class l{constructor(e){e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}update(e){if(!(e&&e.type&&e.viewport&&e.dataViews&&0!==e.dataViews.length&&e.dataViews[0]))return;const t=e.dataViews[0];this.settings=l.parseSettings(t);let s=null;t.scriptResult&&t.scriptResult.payloadBase64&&(s=t.scriptResult.payloadBase64),-1===n.indexOf(e.type)?s&&this.injectCodeFromPayload(s):this.onResizing(e.viewport)}onResizing(e){}injectCodeFromPayload(e){if((0,i.Tx)(),!e)return;let t=document.createElement(\"html\");try{t.innerHTML=o.atob(e)}catch(e){return}if(0===this.headNodes.length){for(;this.headNodes.length>0;){let e=this.headNodes.pop();document.head.removeChild(e)}let e=t.getElementsByTagName(\"head\");if(e&&e.length>0){let t=e[0];this.headNodes=(0,i.Kq)(t,document.head)}}for(;this.bodyNodes.length>0;){let e=this.bodyNodes.pop();this.rootElement.removeChild(e)}let s=t.getElementsByTagName(\"body\");if(s&&s.length>0){let e=s[0];this.bodyNodes=(0,i.Kq)(e,this.rootElement)}(0,i.ME)()}static parseSettings(e){return r.Jx.parse(e)}enumerateObjectInstances(e){return r.Jx.enumerateObjectInstances(this.settings||r.Jx.getDefault(),e)}}},567:(e,t,s)=>{function a(e,t,s){if(!e)return s;let a=e[t];return void 0===a?s:a}s.d(t,{N:()=>a})},982:(e,t,s)=>{s.d(t,{d9:()=>r});var a=s(567);function r(e,t,s){const r=function(e,t,s){return e?a.N(e[t.objectName],t.propertyName,s):s}(e,t,s);return r&&r.solid?r.solid.color:null==r||\"object\"==typeof r&&!r.solid?s:r}},554:(e,t,s)=>{s.d(t,{U:()=>r});var a=s(982);class r{static getDefault(){return new this}static createPropertyIdentifier(e,t){return{objectName:e,propertyName:t}}static parse(e){let t,s=this.getDefault();if(!e||!e.metadata||!e.metadata.objects)return s;t=s.getProperties();for(let r in t)for(let i in t[r]){const o=s[r][i];s[r][i]=a.d9(e.metadata.objects,t[r][i],o)}return s}static isPropertyEnumerable(e){return!r.InnumerablePropertyPrefix.test(e)}static enumerateObjectInstances(e,t){let s=e&&e[t.objectName];if(!s)return[];let a={objectName:t.objectName,selector:null,properties:{}};for(let e in s)s.hasOwnProperty(e)&&(a.properties[e]=s[e]);return{instances:[a]}}getProperties(){let e={};return Object.keys(this).forEach((t=>{if(r.isPropertyEnumerable(t)){let s=Object.keys(this[t]);e[t]={},s.forEach((s=>{r.isPropertyEnumerable(t)&&(e[t][s]=r.createPropertyIdentifier(t,s))}))}})),e}}r.InnumerablePropertyPrefix=/^_/},738:e=>{e.exports=Function(\"return this\")()}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};(()=>{s.r(a),s.d(a,{default:()=>i});var e=s(699),t=s(738).powerbi,r={name:\"demoCreation522AEF1866B94124B4C4F588A968843A\",displayName:\"Overlayering Stacked Column chart\",class:\"Visual\",apiVersion:\"3.8.0\",create:t=>{if(e.u)return new e.u(t);throw\"Visual instance not found\"},createModalDialog:(e,t,s)=>{const a=globalThis.dialogRegistry;e in a&&new a[e](t,s)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.demoCreation522AEF1866B94124B4C4F588A968843A=r);const i=r})(),demoCreation522AEF1866B94124B4C4F588A968843A=a})();","css":"","iconBase64":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QDGRXhpZgAATU0AKgAAAAgABFEQAAEAAAABAQAAAFERAAQAAAABAAAOxFESAAQAAAABAAAOxIdpAAQAAAABAAAAPgAAAAAAAZKGAAcAAABuAAAAUAAAAABVTklDT0RFAAB4AHIAOgBkADoARABBAEYANQBrAEwAZwBTAGMAYgBnADoANQAsAGoAOgAzADYAMgA0ADYAOAA2ADkAMwA3ADAAMAAyADMAMwAzADAANQAyACwAdAA6ADIANAAwADEAMQAxADAAOP/bAEMAAgEBAgEBAgICAgICAgIDBQMDAwMDBgQEAwUHBgcHBwYHBwgJCwkICAoIBwcKDQoKCwwMDAwHCQ4PDQwOCwwMDP/bAEMBAgICAwMDBgMDBgwIBwgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDP/AABEIABQAEwMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOI8HW3hn4QWvhr4gX/hXxPp+seAZ9L1u+tbbTL5ri4NjcrNdbS8SwlpYdzfvHTY8O3eVbcf17+PPxpX9onWtH+HXij4f+MPBs1n4m8N3epWGtXdg8eqWN9NqKRhXsLycEeZp8u5XKnhCAQePE/jOmq2X7IF54hm8WeONTvPHnw+8fHWbbUfEd5e2M3lafdNFstpZGhh2FRt8tFwOOnFez/tC/8AJ+8f/dPv/Tj4rr6ziriiWdVITlBx5b7y5t7eSslbzPLyzLVg4tJ3vbpbb5s+a/ijqV98KPil4o8O+HNS1bSND0nWb2Czs7e/mEVun2iQ7VG7gZJoqL9pP/k4bxz/ANh69/8AR70V8meoaXgeW/8Ai/4i8efDDWdVvH8L+C/CnjCw0xYo4Y7hEuYpYHLP5fzMEkbbkYBxkHpUek/HPxX8Vfhv8RPivq2rM3i7w1eeFIbF4raFLeNbS61SSPMez5sm+m3ZPICYxg5KKAOt+DvwXsv2hfAUPjXxHqWrSa54kuru8vGtzDFEXN1KPlXy+BgDiiiigD//2Q=="},"visualEntryPoint":"","toolsVersion":null}