{"visual":{"name":"demoCreation","displayName":"demoCreation","guid":"demoCreation522AEF1866B94124B4C4F588A968843A","visualClassName":"Visual","version":"1.0.0.0","description":"Demo","supportUrl":"Demo.dk","gitHubUrl":""},"author":{"name":"Andreas Methling","email":"andreas.methling@gmail.com"},"apiVersion":"3.8.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Category","description":"Category to show on the x_axis","name":"category","kind":"Grouping"},{"displayName":"Lower column value 1","name":"l_col1","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 2","name":"l_col2","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 3","name":"l_col3","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 4","name":"l_col4","kind":"GroupingOrMeasure"},{"displayName":"Lower column value 5","name":"l_col5","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 1","name":"u_col1","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 2","name":"u_col2","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 3","name":"u_col3","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 4","name":"u_col4","kind":"GroupingOrMeasure"},{"displayName":"Upper column value 5","name":"u_col5","kind":"GroupingOrMeasure"},{"displayName":"Small Multiple","name":"small_multi","kind":"GroupingOrMeasure"}],"dataViewMappings":[{"conditions":[{"category":{"max":1},"l_col1":{"max":1},"l_col2":{"min":0,"max":1},"l_col3":{"min":0,"max":1},"l_col4":{"min":0,"max":1},"l_col5":{"min":0,"max":1},"u_col1":{"max":1},"u_col2":{"min":0,"max":1},"u_col3":{"min":0,"max":1},"u_col4":{"min":0,"max":1},"u_col5":{"min":0,"max":1},"small_multi":{"min":0,"max":1}}],"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"category"}},{"for":{"in":"l_col1"}},{"for":{"in":"l_col2"}},{"for":{"in":"l_col3"}},{"for":{"in":"l_col4"}},{"for":{"in":"l_col5"}},{"for":{"in":"u_col1"}},{"for":{"in":"u_col2"}},{"for":{"in":"u_col3"}},{"for":{"in":"u_col4"}},{"for":{"in":"u_col5"}},{"for":{"in":"small_multi"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"############### Utility functions ###############\nlibraryRequireInstall = function(packageName, ...)\n{\n  if(!require(packageName, character.only = TRUE)) \n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\n}\n\nlibraryRequireInstall(\"xml2\")\nlibraryRequireInstall(\"htmlwidgets\")\n\ninternalSaveWidget <- function(widget, fname)\n{\n  tempFname = paste(fname, \".tmp\", sep=\"\")\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\n  FlattenHTML(tempFname, fname)\n}\n\nFlattenHTML <- function(fnameIn, fnameOut)\n{\n  # Read and parse HTML file\n  # Embed all js and css files into one unified file\n  \n  if(!file.exists(fnameIn))\n    return(FALSE)\n  \n  dir = dirname(fnameIn)\n  html = read_html(fnameIn, useInternal = TRUE)\n  top = xml_root(html)\n  \n  # extract all <script> tags with src value\n  srcNode=xml_find_all(top, '//script[@src]')\n  for (node in srcNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['src'])\n    alternateSrc = FindSrcReplacement(fname)\n    if (!is.null(alternateSrc))\n    {\n      s = alternateSrc\n      names(s) = 'src'\n      newNode = xml_new_root(\"script\")\n      xml_set_attrs(newNode, s)\n      xml_replace(node, newNode)\n    }else{\n      str=ReadFileForEmbedding(fname);\n      if (!is.null(str))\n      {      \n        newNode = xml_new_root(\"script\",str)\n        xml_set_attrs( newNode, c( type = \"text/javascript\") )\n        xml_replace(node, newNode)\n      }\n    }\n  }\n  \n  # extract all <link> tags with src value\n  linkNode=xml_find_all(top, '//link[@href]')\n  for (node in linkNode)\n  {\n    b = xml_attrs(node)\n    fname = file.path(dir, b['href'])\n    str = ReadFileForEmbedding(fname, FALSE);\n    if (!is.null(str))\n    {\n      newNode = xml_new_root(\"style\", str)\n      xml_replace(node, newNode)\n    }\n  }\n  \n  write_xml(html, file = fnameOut)\n  return(TRUE)\n}\n\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\n{\n  data = ReadFullFile(fname)\n  if (is.null(data))\n    return(NULL)\n\n  str = paste(data, collapse ='\\n')\n  if (addCdata) {\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\n  }\n  return(str)\n}\n\nReadFullFile <- function(fname)\n{\n  if(!file.exists(fname))\n    return(NULL)\n  \n  con = file(fname, open = \"r\")\n  data = readLines(con)\n  close(con)\n  return(data)\n}\n\nFindSrcReplacement <- function(str)\n{\n  # finds reference to 'plotly' js and replaces with a version from CDN\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\n  str <- iconv(str, to=\"UTF-8\")\n  pattern = \"plotly-(\\\\w.+)/plotly-latest.min.js\"\n  match1=regexpr(pattern, str)\n  attr(match1, 'useBytes') <- FALSE\n  strMatch=regmatches(str, match1, invert = FALSE)\n  if (length(strMatch) == 0) return(NULL)\n  \n  pattern2 = \"-(\\\\d.+)/\"\n  match2 = regexpr(pattern2, strMatch[1])\n  attr(match2, 'useBytes') <- FALSE\n  strmatch = regmatches(strMatch[1], match2)\n  if (length(strmatch) == 0) return(NULL)\n  \n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\n  # This matches the specific version used in the plotly package used.\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\n  return(str)\n}\n\nReadFullFileReplaceString <- function(fnameIn, fnameOut, sourceString,targetString) {\n  # Replaces texts in file\n  # This makes it possible to replace e.g. paddings in the generated html widget code\n  if(!file.exists(fnameIn))\n    return(NULL)\n  tx  <- readLines(fnameIn,encoding = \"UTF-8\")\n  tx2  <- gsub(pattern = sourceString, replace = targetString, x = tx)\n  writeLines(tx2, con = fnameOut)\n}\n#################################################\n\n\n############### Library Declarations ###############\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"ggplot2\")));\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"plotly\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"tidyverse\")))\nsuppressWarnings(suppressMessages(libraryRequireInstall(\"scales\")))\n####################################################\n\n################### Actual code ####################\n###################Dealing with errors##############\nif(!exists(\"category\")) {\n  errorText <- \"There needs to be a categorical column\n                </br> in the Category field\"\n  g = ggplot() + geom_text(aes(x = 0.5, y = 0.5, label = errorText), size = 5) +\n    theme(\n      axis.title.x = element_blank(),\n      axis.text.x = element_blank(),\n      axis.ticks.x = element_blank(),\n      axis.title.y = element_blank(),\n      axis.text.y = element_blank(),\n      axis.ticks.y = element_blank()\n    )\n  p = ggplotly(g) %>%\n    layout(plot_bgcolor='#FFFFFF',\n           yaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE),\n           xaxis = list(zerolinecolor = '#ffff',\n                        zerolinewidth = 2,\n                        gridcolor = 'ffff',\n                        showticklabels=FALSE))\n  internalSaveWidget(p, 'out.html')\n  ReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n  quit()                       \n}\n\n\n#############Create Values- dataset from user selected fields####################\n# Set the number of columns\nnum_l_cols <- 5\nnum_u_cols <- 5\n\ncategory[] <- lapply(category[1], as.character)\n\nValues <- data.frame(category)\nValues2 <- data.frame(category)\n\n\n# Initialize Values and Values2\nif (exists(\"small_multi\")) {\n  small_multi[] <- lapply(small_multi[1], as.character)\n\n  Values <- data.frame(category, small_multi)\n\n  Values2 <- data.frame(category, small_multi)\n\n  colnames(Values2)[length(Values2)] = \"small\"\n\n  colnames(Values)[length(Values)] = \"small\"\n}\n\n# Loop through l_cols\nfor (i in 1:num_l_cols) {\n  l_col_name <- paste(\"l_col\", i, sep=\"\")\n  if (exists(\"category\") && exists(l_col_name)) {\n    Values[[l_col_name]] <- get(l_col_name)\n  }\n}\n\n# Loop through u_cols\nfor (i in 1:num_u_cols) {\n  u_col_name <- paste(\"u_col\", i, sep=\"\")\n  if (exists(\"category\") && exists(u_col_name)) {\n    Values2[[u_col_name]] <- get(u_col_name)\n  }\n}\n\n\n#######Color Specefications\ndefault_labels <- c(\"blue\", \"#ADD8E6\", \"#1BD8E6\", \"red\", \"orange\", \"green\", \"lightgreen\", \"chartreuse\", \"lightyellow\", \"purple\")\ncolors = c()\ncolors2 = c()\n\nfor (i in 1:num_l_cols) {\n  label_name <- paste(\"LowerColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  l_col_name <- paste(\"l_col\", i, sep=\"\")\n  if (!exists(label_name) && exists(l_col_name)) {\n    colors = append(colors, default_labels[i])\n  } else if (exists(label_name) && exists(l_col_name)){\n    pick = get(label_name)\n    colors = append(colors, pick)\n  }\n}\n\nfor (i in 1:num_u_cols) {\n  label_name <- paste(\"UpperColumnValue\", i, \"Format_colLabel\", sep = \"\")\n  u_col_name <- paste(\"u_col\", i, sep=\"\")\n  label = 5 + i\n  if (!exists(label_name) && exists(u_col_name)) {\n    colors2 = append(colors2, default_labels[label])\n  } else if (exists(label_name) && exists(u_col_name)){\n    pick = get(label_name)\n    colors2 = append(colors2, pick)\n  }\n}\n\ncolors = append(colors, colors2)\n\n###########Transforming Dataframe###############\ncolnames(Values)[1] = \"x_axis\"\ncolnames(Values2)[1] = \"x_axis\"\n\n\nif (length(Values) > 2 && exists(\"small_multi\")) {\n    df = Values %>% \n      group_by(x_axis, small) %>% \n      summarise_all(.funs = c(sum=\"sum\")) %>%\n      pivot_longer(c(-x_axis, -small), names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10))\n  }  else if (length(Values) > 1 && !exists(\"small_multi\")) {\n    df = Values %>% \n      group_by(x_axis) %>% \n      summarise_all(.funs = c(sum=\"sum\")) %>%\n      pivot_longer(-x_axis, names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10))\n}\n\nif (length(Values2) > 2 && exists(\"small_multi\")) {\n\n    df2 = Values2 %>% \n      group_by(x_axis, small) %>% \n      summarise_all(.funs = c(sum=\"sum\")) %>%\n      pivot_longer(c(-x_axis, -small), names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10))\n    } else if (length(Values2) > 1 && !exists(\"small_multi\")){\n    df2 = Values2 %>% \n      group_by(x_axis) %>% \n      summarise_all(.funs = c(sum=\"sum\")) %>%\n      pivot_longer(-x_axis, names_to = \"type\", values_to = \"values\") %>%\n      mutate(newx_axis = str_wrap(x_axis, width = 10))\n}\n\nif (exists(\"small_multi\")) {\n   if(length(Values2) < 3) {\ng = ggplot(df) +\n  geom_col(aes(x =newx_axis,\n               y = values,\n               fill = type),\n           width = 0.6) +\n  facet_wrap(~small)+\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n   } else if (length(Values) < 3){\n  g = ggplot(df2) +\n  geom_col( aes(newx_axis,  \n               y = values, fill = type), \n           width = 0.35) +\n  facet_wrap(~small)+\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n   } else {\n  g = ggplot(df) +\n  geom_col(aes(x =newx_axis,\n               y = values,\n               fill = type),\n           width = 0.6) +\n   geom_col(data = df2, aes(newx_axis,  \n               y = values, fill = type), \n           width = 0.35,\n           inherit.aes = FALSE) +\n             facet_wrap(~small)+\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n  \n\n   }\n} else if (!exists(\"small_multi\")) {\n  if (length(Values2) < 2){\ng = ggplot(df) +\n  geom_col(aes(x =newx_axis,\n               y = values,\n               fill = type),\n           width = 0.6) +\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n  } else if (length(Values) < 2) {\ng = ggplot(df2) +\n  geom_col( aes(newx_axis,  \n               y = values, fill = type), \n           width = 0.35) +\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n  }\n} else {\ng = ggplot(df) +\n  geom_col(aes(x =newx_axis,\n               y = values,\n               fill = type),\n           width = 0.6) +\n   geom_col(data = df2, aes(newx_axis,  \n               y = values, fill = type), \n           width = 0.35,\n           inherit.aes = FALSE) +\n  scale_fill_manual(values = colors,\n                     name = NULL)+\n           scale_y_continuous(labels = comma_format(big.mark = \".\", \n                                               decimal.mark = \",\"))+\n              labs(x = \"\", y = \"\");\n  \n}\n\ng2 = ggplot() + geom_text(aes(x = 0.5, y = 0.5, label = colors))\n####################################################\n\n############# Create and save widget ###############\np = ggplotly(g, tooltip =c(\"values\"))%>%\n  layout(plot_bgcolor='#FFFFFF',\n         yaxis = list(gridcolor = \"#F1F2F3\",\n                      gridwidth = 0.1),\n         legend = list(orientation = 'h',\n                       y = 1.1,\n                       font = list(size = 9),\n                       title=list(text='')),\n         hoverlabel = list(align = \"left\")\n  ) %>% \n  config(displayModeBar = F);\n\np2 = ggplotly(g2)\ninternalSaveWidget(p, 'out.html');\n####################################################\n\n################ Reduce paddings ###################\nReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":[0-9]*,', ',\"padding\":0,')\n####################################################"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"settings":{"displayName":"Visual Settings","description":"Visual Settings Tooltip","properties":{"lineColor":{"displayName":"Line Color","type":{"fill":{"solid":{"color":true}}}}}},"LowerColumnValue1Format":{"displayName":"Lower column value 1","description":"Lower column value 1 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"LowerColumnValue2Format":{"displayName":"Lower column value 2","description":"Lower column value 2 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"LowerColumnValue3Format":{"displayName":"Lower column value 3","description":"Lower column value 3 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"LowerColumnValue4Format":{"displayName":"Lower column value 4","description":"Lower column value 4 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"LowerColumnValue5Format":{"displayName":"Lower column value 5","description":"Lower column value 5 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"UpperColumnValue1Format":{"displayName":"Upper column value 1","description":"Upper column value 1 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"UpperColumnValue2Format":{"displayName":"Upper column value 2","description":"Upper column value 2 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"UpperColumnValue3Format":{"displayName":"Upper column value 3","description":"Upper column value 3 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"UpperColumnValue4Format":{"displayName":"Upper column value 4","description":"Upper column value 4 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"UpperColumnValue5Format":{"displayName":"Upper column value 5","description":"Upper column value 5 settings","properties":{"colLabel":{"displayName":"color","description":"color of bar","type":{"fill":{"solid":{"color":true}}}}}},"mySettingsAxes":{"displayName":"Axes","description":"Axes and labels settings","properties":{"colLabel":{"displayName":"Labels color","description":"Labels color","type":{"fill":{"solid":{"color":true}}}},"textSize":{"displayName":"Labels size","type":{"numeric":true}},"sizeTicks":{"displayName":"Size ticks","description":"Size ticks","type":{"enumeration":[{"displayName":"None","value":"0"},{"displayName":"4","value":"4"},{"displayName":"6","value":"6"},{"displayName":"8","value":"8"},{"displayName":"10","value":"10"},{"displayName":"12","value":"12"},{"displayName":"14","value":"14"},{"displayName":"16","value":"16"},{"displayName":"18","value":"18"},{"displayName":"20","value":"20"}]}},"axisLine":{"displayName":"Axis line","type":{"bool":true}}}}},"suppressDefaultTitle":false},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"xml2","displayName":"xml2","url":"https://cran.r-project.org/web/packages/xml2/index.html"}]},"content":{"js":"var demoCreation522AEF1866B94124B4C4F588A968843A;(()=>{\"use strict\";var e={934:(e,t,r)=>{r.d(t,{Kq:()=>a,ME:()=>l,Tx:()=>n});var s=r(738);let o=0;function n(){o=0}function a(e,t){let r=[];if(!e||!e.hasChildNodes())return;let s=e.children;for(let e=0;e<s.length;e++){let o;o=\"script\"===s.item(e).nodeName.toLowerCase()?i(s.item(e)):s.item(e).cloneNode(!0),t.appendChild(o),r.push(o)}return r}function i(e){let t=document.createElement(\"script\"),r=e.attributes;for(let e=0;e<r.length;e++)t.setAttribute(r[e].name,r[e].textContent),\"src\"===r[e].name.toLowerCase()&&(o++,t.onload=()=>{o--});return t.innerHTML=e.innerHTML,t}function l(){let e=s.setInterval((()=>{0===o&&(s.clearInterval(e),s.hasOwnProperty(\"HTMLWidgets\")&&s.HTMLWidgets.staticRender&&s.HTMLWidgets.staticRender())}),100)}},50:(e,t,r)=>{r.d(t,{Jx:()=>o});var s=r(554).U;class o extends s{constructor(){super(...arguments),this.settings_Legend_params=new a,this.mySettingsAxes=new i,this.LowerColumnValue1Format=new l,this.LowerColumnValue2Format=new c,this.LowerColumnValue3Format=new u,this.LowerColumnValue4Format=new d,this.LowerColumnValue5Format=new h,this.UpperColumnValue1Format=new m,this.UpperColumnValue2Format=new p,this.UpperColumnValue3Format=new g,this.UpperColumnValue4Format=new y,this.UpperColumnValue5Format=new b,this.rcv_script=new n}}class n{}class a{constructor(){this.Legend_Theme=\"Blues\"}}class i{constructor(){this.colLabel=\"grey\",this.textSize=10,this.sizeTicks=\"8\",this.axisLine=!1}}class l{constructor(){this.colLabel=\"grey\"}}class c{constructor(){this.colLabel=\"grey\"}}class u{constructor(){this.colLabel=\"grey\"}}class d{constructor(){this.colLabel=\"grey\"}}class h{constructor(){this.colLabel=\"grey\"}}class m{constructor(){this.colLabel=\"#FF0000\"}}class p{constructor(){this.colLabel=\"gray\"}}class g{constructor(){this.colLabel=\"gray\"}}class y{constructor(){this.colLabel=\"gray\"}}class b{constructor(){this.colLabel=\"gray\"}}},728:(e,t,r)=>{r.d(t,{u:()=>l});var s,o=r(50),n=r(934),a=r(738);!function(e){e[e.Data=2]=\"Data\",e[e.Resize=4]=\"Resize\",e[e.ViewMode=8]=\"ViewMode\",e[e.Style=16]=\"Style\",e[e.ResizeEnd=32]=\"ResizeEnd\",e[e.All=62]=\"All\"}(s||(s={}));const i=[s.Resize,s.ResizeEnd,s.Resize+s.ResizeEnd];class l{constructor(e){e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}update(e){if(!(e&&e.type&&e.viewport&&e.dataViews&&0!==e.dataViews.length&&e.dataViews[0]))return;const t=e.dataViews[0];this.settings=l.parseSettings(t);let r=null;t.scriptResult&&t.scriptResult.payloadBase64&&(r=t.scriptResult.payloadBase64),-1===i.indexOf(e.type)?r&&this.injectCodeFromPayload(r):this.onResizing(e.viewport)}onResizing(e){}injectCodeFromPayload(e){if((0,n.Tx)(),!e)return;let t=document.createElement(\"html\");try{t.innerHTML=a.atob(e)}catch(e){return}if(0===this.headNodes.length){for(;this.headNodes.length>0;){let e=this.headNodes.pop();document.head.removeChild(e)}let e=t.getElementsByTagName(\"head\");if(e&&e.length>0){let t=e[0];this.headNodes=(0,n.Kq)(t,document.head)}}for(;this.bodyNodes.length>0;){let e=this.bodyNodes.pop();this.rootElement.removeChild(e)}let r=t.getElementsByTagName(\"body\");if(r&&r.length>0){let e=r[0];this.bodyNodes=(0,n.Kq)(e,this.rootElement)}(0,n.ME)()}static parseSettings(e){return o.Jx.parse(e)}enumerateObjectInstances(e){return o.Jx.enumerateObjectInstances(this.settings||o.Jx.getDefault(),e)}}},567:(e,t,r)=>{function s(e,t,r){if(!e)return r;let s=e[t];return void 0===s?r:s}r.d(t,{N:()=>s})},982:(e,t,r)=>{r.d(t,{d9:()=>o});var s=r(567);function o(e,t,r){const o=function(e,t,r){return e?s.N(e[t.objectName],t.propertyName,r):r}(e,t,r);return o&&o.solid?o.solid.color:null==o||\"object\"==typeof o&&!o.solid?r:o}},554:(e,t,r)=>{r.d(t,{U:()=>o});var s=r(982);class o{static getDefault(){return new this}static createPropertyIdentifier(e,t){return{objectName:e,propertyName:t}}static parse(e){let t,r=this.getDefault();if(!e||!e.metadata||!e.metadata.objects)return r;t=r.getProperties();for(let o in t)for(let n in t[o]){const a=r[o][n];r[o][n]=s.d9(e.metadata.objects,t[o][n],a)}return r}static isPropertyEnumerable(e){return!o.InnumerablePropertyPrefix.test(e)}static enumerateObjectInstances(e,t){let r=e&&e[t.objectName];if(!r)return[];let s={objectName:t.objectName,selector:null,properties:{}};for(let e in r)r.hasOwnProperty(e)&&(s.properties[e]=r[e]);return{instances:[s]}}getProperties(){let e={};return Object.keys(this).forEach((t=>{if(o.isPropertyEnumerable(t)){let r=Object.keys(this[t]);e[t]={},r.forEach((r=>{o.isPropertyEnumerable(t)&&(e[t][r]=o.createPropertyIdentifier(t,r))}))}})),e}}o.InnumerablePropertyPrefix=/^_/},738:e=>{e.exports=Function(\"return this\")()}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var s={};(()=>{r.r(s),r.d(s,{default:()=>n});var e=r(728),t=r(738).powerbi,o={name:\"demoCreation522AEF1866B94124B4C4F588A968843A\",displayName:\"demoCreation\",class:\"Visual\",apiVersion:\"3.8.0\",create:t=>{if(e.u)return new e.u(t);throw\"Visual instance not found\"},createModalDialog:(e,t,r)=>{const s=globalThis.dialogRegistry;e in s&&new s[e](t,r)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.demoCreation522AEF1866B94124B4C4F588A968843A=o);const n=o})(),demoCreation522AEF1866B94124B4C4F588A968843A=s})();","css":"","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":"","toolsVersion":null}